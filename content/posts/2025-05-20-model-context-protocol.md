---
title: 入门MCP（Model Context Protocol）
author:
  - 波叔
date: '2025-05-20'
slug: Model Context Protocol
categories:
  - 人工智能
tags:
  - tech
  - MCP
  - 人工智能
lastmod: '2025-05-20T23:42:50+08:00'
keywords:
  - 人工智能
  - Model Context Protocol
  - AI
  - MCP
description: '什么是MCP（Model Context Protocol），MCP可以帮助我们干哪些活？其在医疗领域有哪些应用场景？我们一起来了解。'
summary: '随着人工智能技术的快速发展，大语言模型已经成为各行各业数字化转型的重要推动力。但即使是最先进的模型也面临着一个根本性挑战：它们与外部数据和工具的连接往往是孤立和碎片化的。'
weight: ~
draft: no
comments: yes
showToc: yes
TocOpen: yes
autonumbering: yes
hidemeta: no
disableShare: yes
searchHidden: no
showbreadcrumbs: yes
mermaid: yes
cover:
  image: ''
  caption: ''
  alt: ''
  relative: no
---

## 引言

随着人工智能技术的快速发展，大语言模型（LLM）已经成为各行各业数字化转型的重要推动力。然而，即使是最先进的模型也面临着一个根本性挑战：它们与外部数据和工具的连接往往是孤立和碎片化的。每个新的数据源或工具都需要定制集成，这不仅增加了开发成本，还限制了AI系统的灵活性和可扩展性。

Model Context Protocol（MCP，模型上下文协议）应运而生，旨在解决这一核心挑战。本文将系统性地探讨MCP的定义、必要性、使用方法、不同实现的比较，以及它在医疗领域的应用优势，帮助读者全面了解这一革命性技术标准。

## 一、什么是MCP（Model Context Protocol）

### 1.1 MCP的定义与基本概念

Model Context Protocol（MCP）是一个开放标准，用于规范应用程序如何向大语言模型（LLM）提供上下文。根据Anthropic（MCP的发起者）的官方定义，MCP是"一种新标准，用于将AI助手连接到数据所在的系统，包括内容存储库、业务工具和开发环境"。

MCP可以被形象地比喻为AI应用的"USB-C接口"。正如USB-C提供了一种标准化的方式来连接设备与各种外设和配件，MCP提供了一种标准化的方式来连接AI模型与不同的数据源和工具。这种标准化接口极大地简化了AI系统与外部世界的交互方式。

![MCP](https://learnprompting.org/blog/mcp-norah.png)

从技术架构上看，MCP遵循客户端-服务器模型。在这个模型中：

- **MCP主机**：如Claude桌面应用、集成开发环境（IDE）或其他AI工具，它们希望通过MCP访问数据。
- **MCP客户端**：协议客户端，与服务器维持1:1的连接。
- **MCP服务器**：轻量级程序，每个服务器通过标准化的Model Context Protocol暴露特定功能。
- **本地数据源**：计算机上的文件、数据库和服务，MCP服务器可以安全地访问这些资源。
- **远程服务**：通过互联网可用的外部系统（例如，通过API），MCP服务器可以连接到这些系统。

### 1.2 MCP的发展背景

MCP的出现代表了大语言模型应用发展的第三个阶段。根据Mindbowser的分析，LLM的发展经历了三个明显的阶段：

第一阶段是基础LLM，仅限于文本生成。在这个阶段，LLM只能预测序列中的下一个词，虽然在生成内容或回答知识性问题方面令人印象深刻，但无法在现实世界中执行有意义的操作。

第二阶段是LLM与工具的直接集成。开发者将LLM与外部工具和API连接起来，使其能够搜索互联网、访问数据库、处理电子邮件等。然而，这种方法面临着显著挑战："当你想构建一个能做多种事情的助手时，会变得令人沮丧...你成为将不同工具粘合到这些LLM上的人，这可能会变得非常令人沮丧和繁琐。"

第三阶段是LLM与MCP的结合，MCP作为LLM与外部服务之间的标准化协议层："MCP可以被视为LLM与服务和工具之间的一层，这一层将所有不同的语言翻译成统一的语言，使LLM完全理解。"

Anthropic于2024年11月首次公开发布了MCP，旨在解决AI系统与数据源之间的碎片化集成问题。此后，包括OpenAI、deepset等在内的多家主要AI公司和平台也迅速采纳了这一标准。

## 二、为什么我们需要MCP

### 2.1 解决AI系统的孤岛问题

随着AI助手的主流采用，行业在模型能力上投入了大量资源，在推理和质量方面取得了快速进步。然而，即使是最复杂的模型也受到与数据隔离的限制——被困在信息孤岛和遗留系统之后。每个新的数据源都需要自己的定制实现，使真正连接的系统难以扩展。

MCP正是为解决这一挑战而生。它提供了一个通用的、开放的标准，用于连接AI系统与数据源，用单一协议替代碎片化的集成。结果是一种更简单、更可靠的方式，使AI系统能够访问它们需要的数据。

### 2.2 标准化与互操作性的重要性

在AI应用快速发展的今天，标准化和互操作性变得尤为重要。MCP的价值在于：

1. **减少重复工作**：开发者不再需要为每个数据源或工具创建和维护单独的连接器。

2. **提高可靠性**：标准化的接口减少了集成错误和兼容性问题。

3. **促进创新**：开发者可以专注于创建新功能，而不是解决基础集成问题。

4. **增强灵活性**：组织可以轻松切换或添加新的数据源和工具，而无需重大的工程工作。

deepset的博客文章指出，MCP"标准化了数据和工具与AI代理的集成，这对于更快地构建AI应用程序证明非常有价值"。这种标准化类似于REST API如何标准化Web服务通信，使不同系统和平台之间的无缝集成和互操作成为可能。

### 2.3 MCP解决的具体问题

MCP解决了AI应用开发中的几个关键问题：

1. **集成复杂性**：在没有MCP的情况下，每个新的数据源或工具都需要定制集成，这导致了复杂的维护问题和系统脆弱性。MCP提供了一个统一的接口，简化了这一过程。

2. **上下文管理**：AI系统需要适当的上下文才能提供有价值的响应。MCP定义了提供上下文的清晰模式，使AI系统能够更好地理解用户需求和相关信息。

3. **工具使用**：现代AI系统需要能够使用各种工具来完成任务。MCP提供了一个标准化的方式来发现和使用这些工具，使AI系统能够更有效地完成复杂任务。

4. **响应处理**：MCP定义了处理AI响应的标准模式，使应用程序能够一致地解释和使用这些响应。

## 三、如何使用MCP

### 3.1 MCP的基本架构与组件

![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d25a162-5cc0-42cb-a7d9-a63a3210279a_1086x1280.gif)

MCP的基本架构包括以下核心组件：

1. **MCP客户端**：直接连接到LLM的接口。例如，Anthropic的Claude或其他实现平台如Tempo、Windsurf和Cursor。

2. **MCP协议**：规范客户端和服务器之间信息交换的标准化约定集。这确保了无论使用哪些工具或服务，通信都是一致的。

3. **MCP服务器**：在MCP协议和实际服务或工具之间进行翻译。服务提供商负责设置和配置MCP服务器，以确保客户端具有完全的访问权限和功能。

4. **服务**：实际的服务，如数据库、API或其他工具，连接到MCP服务器。

### 3.2 MCP服务器类型与实现方式

![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd5602dcb-64d4-4e3c-9daa-cb2fedf022fa_1456x694.png)

根据OpenAI的文档，MCP规范目前定义了两种类型的服务器，基于它们使用的传输机制：

1. **stdio服务器**：作为应用程序的子进程运行。可以将它们视为"本地"运行。

2. **HTTP over SSE服务器**：远程运行。通过URL连接到它们。

![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9b7f6701-6217-4edc-9927-8df65345818a_1440x1376.png#center)

开发者可以使用`MCPServerStdio`和`MCPServerSse`类来连接这些服务器。例如，使用官方MCP文件系统服务器的方式如下：

```python
async with MCPServerStdio(
    params={
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-filesystem", samples_dir],
    }
) as server:
    tools = await server.list_tools()
```

### 3.3 MCP的使用流程与最佳实践

使用MCP的一般流程包括以下步骤：

1. **选择或创建MCP服务器**：根据需要访问的数据或功能，选择现有的MCP服务器或创建新的服务器。

2. **连接MCP服务器**：使用适当的客户端库（如OpenAI的`MCPServerStdio`或`MCPServerSse`）连接到MCP服务器。

3. **发现可用工具**：调用服务器的`list_tools()`方法，了解可用的工具和功能。

4. **使用工具**：当AI模型需要访问数据或执行操作时，它会调用相应的工具，客户端库会将请求转发给适当的MCP服务器。

5. **处理结果**：处理从MCP服务器返回的结果，并将其整合到AI系统的响应中。

最佳实践包括：

- **缓存工具列表**：如OpenAI文档所建议的，可以通过传递`cache_tools_list=True`参数来缓存工具列表，减少延迟，特别是对于远程服务器。

- **安全考虑**：确保MCP服务器只暴露必要的功能，并实施适当的访问控制。

- **错误处理**：实施健壮的错误处理机制，以应对MCP服务器可能的故障或不可用情况。

## 四、不同MCP实现的比较

### 4.1 Anthropic的MCP实现

作为MCP的发起者，Anthropic的实现具有以下特点：

**协议细节与架构**：Anthropic的MCP实现采用了清晰的客户端-服务器架构。该架构包括三个主要组件：MCP规范和SDK、Claude桌面应用中的本地MCP服务器支持，以及开源MCP服务器存储库。

Anthropic的实现特别强调了MCP服务器的灵活性，允许开发者快速连接各种数据源。Claude 3.5 Sonnet模型被设计为能够快速构建MCP服务器实现，使组织和个人能够轻松地将其重要数据集与各种AI工具连接起来。

**生态系统与兼容性**：Anthropic已经为多个企业系统预构建了MCP服务器，包括Google Drive、Slack、GitHub、Git、Postgres和Puppeteer等。这表明其实现注重与现有企业工具的广泛兼容性。

早期采用者如Block和Apollo已将MCP集成到其系统中，而开发工具公司如Zed、Replit、Codeium和Sourcegraph正在使用MCP增强其平台，使AI代理能够更好地检索相关信息，更好地理解编码任务的上下文，并生成更细致和功能性的代码。

**安全性考虑**：Anthropic的MCP实现特别强调安全性，允许开发者构建"安全的双向连接"。这表明其设计考虑了数据安全和隐私保护的需求，特别是在处理敏感企业数据时。

### 4.2 OpenAI的MCP实现

OpenAI虽然不是MCP的发起者，但已经在其Agents SDK中提供了对MCP的支持：

**协议细节与架构**：OpenAI的MCP实现遵循了标准的MCP规范，支持两种类型的服务器：基于stdio的本地服务器和基于HTTP over SSE的远程服务器。OpenAI提供了`MCPServerStdio`和`MCPServerSse`类来连接这些服务器。

OpenAI的实现特别强调了与其Agent框架的集成，允许开发者将MCP服务器添加到Agent中。每次Agent运行时，SDK会调用MCP服务器的`list_tools()`方法，使LLM了解MCP服务器的工具。当LLM调用MCP服务器的工具时，SDK会在该服务器上调用`call_tool()`。

**性能优化**：OpenAI的实现特别关注性能优化，提供了工具列表缓存功能。文档指出："每次Agent运行时，它都会调用MCP服务器上的`list_tools()`。这可能会导致延迟，特别是如果服务器是远程服务器。为了自动缓存工具列表，你可以向`MCPServerStdio`和`MCPServerSse`传递`cache_tools_list=True`。"

**可追踪性**：OpenAI的MCP实现包含了追踪功能，自动捕获MCP操作，包括调用MCP服务器列出工具的操作和函数调用上的MCP相关信息。这为开发者提供了更好的调试和监控能力。

### 4.3 deepset的Haystack MCP实现

deepset在其Haystack开源框架中集成了MCP支持，为自定义AI应用提供了灵活性：

**协议细节与架构**：deepset的MCP实现采用了双向集成方式：一方面，新的`MCPTool`类使Haystack Pipeline作为MCP客户端能够与现有MCP服务器无缝通信；另一方面，用户还可以将Haystack Pipeline包装成MCP服务器，并将其作为工具暴露给MCP客户端交互。

这种双向集成方式使Haystack成为一个灵活的平台，既可以利用现有的MCP生态系统，也可以为该生态系统做出贡献。

**适用场景与优势**：deepset的MCP实现特别强调了在复合AI（Compound AI）系统中的应用。复合AI由多个自包含组件组成，可以包括AI模型、非AI业务逻辑和额外的数据源。这种模块化方法已成为复杂AI应用的标准，允许独立评估和替换组件。

MCP完美契合这种模块化概念，对基于AI代理的系统特别有价值，这些系统依赖于基于上下文和目标访问和编排工具。

**开源性与所有权**：deepset的实现特别强调了开源性和用户对解决方案的完全所有权。由于Haystack的开源性质，用户永远不会被锁定在专有的"黑盒"格式中。这与其他一些MCP实现形成了对比，提供了更大的透明度和控制权。

### 4.4 不同MCP实现的共同点与差异

**共同点**：

1. **标准化接口**：所有实现都遵循MCP的基本原则，提供标准化的方式来连接AI模型与数据源和工具。

2. **客户端-服务器架构**：所有实现都采用了客户端-服务器模型，其中AI应用作为客户端连接到提供特定工具或数据源访问的MCP服务器。

3. **工具发现机制**：所有实现都支持工具发现机制，允许AI模型了解可用的工具和功能。

4. **开放性**：所有实现都强调了开放性和互操作性，允许不同系统之间的无缝集成。

**差异点**：

1. **集成重点**：Anthropic的实现更注重与企业系统的广泛集成；OpenAI的实现更专注于与其Agent框架的紧密集成；deepset的实现则强调了与其Haystack框架的双向集成。

2. **性能优化**：OpenAI特别关注性能优化，提供了工具列表缓存功能；其他实现可能在不同方面进行了优化。

3. **开源程度**：deepset的实现强调了完全开源和用户对解决方案的所有权；Anthropic也提供了开源组件；OpenAI的实现则是其专有SDK的一部分。

4. **生态系统成熟度**：Anthropic作为MCP的发起者，其生态系统可能更成熟，提供了更多预构建的连接器；其他实现则可能在特定领域有其独特优势。

## 五、MCP在医疗领域的应用

### 5.1 MCP与医疗数据标准的结合

医疗行业已经在FHIR（Fast Healthcare Interoperability Resources）标准上投入了大量资源，作为电子化交换医疗信息的标准。FHIR的结构化、一致的数据模型与明确定义的资源（如患者、药物、病情等）与MCP的标准化方法完美契合。

根据Mindbowser的分析，"MCP + FHIR对医疗聊天机器人具有革命性意义"。这种结合为医疗AI应用提供了坚实的基础，使得大语言模型能够以标准化的方式访问和理解医疗数据。

在传统医疗AI应用中，每个新的数据源或工具都需要定制集成，这导致了复杂的维护问题和系统脆弱性。MCP通过提供标准化的协议，简化了这一过程。医疗专业人员可以通过MCP将AI助手连接到各种医疗系统，如电子健康记录（EHR）、药房数据库、实验室系统等，而无需为每个系统开发和维护单独的集成点。

### 5.2 医疗领域的MCP应用场景

**临床决策支持**：

MCP使AI助手能够实时访问患者数据、医学文献和临床指南，为医疗专业人员提供更准确、更相关的决策支持。例如，当医生在诊断复杂病例时，AI助手可以通过MCP同时访问患者的历史记录、最新的实验室结果、相关的医学研究和治疗指南，提供全面的分析和建议。这种集成的决策支持可以减少医疗错误，提高诊断准确性。

**医疗文档自动化**：

医疗文档工作占用了医疗专业人员大量时间。MCP使AI助手能够访问多个系统，自动生成和更新医疗文档。通过MCP，AI助手可以从电子健康记录系统提取患者信息，从医学术语数据库获取标准化术语，并根据最新的编码指南生成准确的医疗文档。这不仅提高了效率，还减少了文档错误和不一致。

**患者参与和教育**：

MCP使患者面向的AI应用能够提供个性化的健康信息和教育内容。例如，一个糖尿病管理应用可以通过MCP访问患者的血糖监测数据、饮食记录和活动信息，同时连接到医学知识库和治疗指南，为患者提供个性化的管理建议和教育内容。

**医疗研究和临床试验**：

在医疗研究领域，MCP可以帮助研究人员更有效地访问和分析大量异构数据。研究人员可以使用支持MCP的AI工具同时访问多个研究数据库、患者记录系统和生物医学文献，识别潜在的研究参与者，分析治疗效果，并发现新的研究方向。

### 5.3 MCP在医疗领域的实际案例

**FHIR集成与医疗聊天机器人**：

根据Mindbowser的报告，MCP正在彻底改变医疗聊天机器人的功能。通过将MCP与FHIR集成，医疗聊天机器人能够安全地访问患者记录、提供个性化的健康建议、协助预约和药物管理，以及回答基于患者具体情况的医疗问题。

这种集成使医疗聊天机器人从简单的信息提供者转变为真正的医疗助手，能够理解患者的具体情况并提供相关的支持。

**临床决策支持系统**：

MCP正在增强临床决策支持系统的能力。通过MCP，这些系统可以实时访问患者数据、连接到医学知识库和临床指南、整合多种诊断工具的结果，以及提供基于证据的治疗建议。

这种增强的决策支持帮助医生更快、更准确地做出诊断和治疗决策，特别是在处理复杂或罕见病例时。

## 六、MCP对医疗人员使用大语言模型的优势

### 6.1 降低技术门槛

医疗专业人员通常不具备深厚的技术背景。MCP通过提供标准化的接口，降低了使用AI工具的技术门槛。医生、护士和其他医疗工作者可以专注于临床问题，而不必担心底层技术集成的复杂性。这使得AI工具更容易被医疗团队采用和使用。

### 6.2 增强数据安全和隐私保护

医疗数据的安全性和隐私保护至关重要。MCP的设计考虑了这些关键需求。根据Anthropic的文档，MCP提供了"构建安全的双向连接"的能力。在医疗环境中，这意味着敏感的患者数据可以在本地处理，减少数据暴露的风险。MCP服务器可以在医疗机构的防火墙内运行，确保数据不会离开受保护的环境。

### 6.3 提高互操作性和系统整合

医疗机构通常使用多种不同的系统和工具。MCP使这些系统能够更容易地与AI工具集成。例如，一家医院可以使用MCP将其电子健康记录系统、放射学信息系统、实验室信息系统和药房管理系统连接到同一个AI助手。这种整合使医疗专业人员能够获得全面的患者视图，做出更明智的决策。

### 6.4 适应医疗工作流程的灵活性

医疗工作流程复杂且多样化。MCP的模块化设计使AI工具能够适应不同的工作流程需求。医疗团队可以根据其特定需求配置MCP服务器，连接相关的数据源和工具。这种灵活性使AI助手能够无缝融入现有的医疗工作流程，而不是强制医疗专业人员改变其工作方式。

### 6.5 促进医疗AI的持续创新

MCP的开放标准促进了医疗AI领域的创新和协作。开发者可以创建专门针对医疗用例的MCP服务器，如FHIR数据访问、医学图像分析或医学文献搜索。这些服务器可以被医疗机构和研究人员共享和重用，加速医疗AI的发展和应用。

## 七、医疗领域MCP应用的挑战与解决方案

### 7.1 合规性和监管要求

医疗行业受到严格的监管，如HIPAA（美国健康保险可携性和责任法案）和GDPR（欧盟通用数据保护条例）。

**解决方案**：MCP的设计考虑了数据安全和隐私保护。医疗机构可以在其防火墙内部署MCP服务器，确保敏感数据不会离开受保护的环境。此外，MCP可以与现有的访问控制和审计系统集成，确保合规性。

### 7.2 数据质量和标准化

医疗数据通常分散在多个系统中，格式和质量各不相同。

**解决方案**：MCP可以与数据标准化工具结合使用，如FHIR转换器，将不同格式的医疗数据转换为标准格式。这确保了AI模型接收到的数据是一致和高质量的。

### 7.3 医疗专业人员的接受度

医疗专业人员可能对新技术持谨慎态度，特别是涉及患者护理的技术。

**解决方案**：MCP的设计强调了易用性和与现有工作流程的集成。通过提供直观的界面和明显的临床价值，MCP支持的AI工具可以更容易被医疗专业人员接受和采用。

## 八、未来展望：MCP在医疗AI中的发展方向

### 8.1 专业医疗MCP服务器生态系统

随着MCP标准的普及，我们可以期待看到专门为医疗用例设计的MCP服务器生态系统的发展。这些服务器将提供专门的功能，如FHIR数据访问、医学图像分析、医学文献搜索等。

### 8.2 多模态医疗AI集成

未来的MCP实现可能会扩展到支持多模态医疗AI，集成文本、图像、语音和传感器数据。这将使AI助手能够处理更复杂的医疗场景，如分析医学图像同时考虑患者的临床历史。

### 8.3 协作医疗AI系统

MCP的标准化协议为构建协作医疗AI系统铺平了道路，其中多个专业AI代理可以协同工作，共同解决复杂的医疗问题。例如，一个诊断代理可以与一个治疗规划代理和一个药物相互作用检查代理协作，为患者提供全面的护理建议。

## 结论

Model Context Protocol (MCP) 作为一种开放标准，正在彻底改变AI系统与外部数据和工具的交互方式。通过提供标准化的接口，MCP解决了长期困扰AI应用开发的碎片化集成问题，使AI系统能够更有效地访问和利用各种数据源和工具。

对于医疗行业，MCP带来了特别显著的价值。通过与FHIR等医疗数据标准的结合，MCP使医疗AI应用能够安全、高效地访问和处理医疗数据，支持临床决策、自动化医疗文档、增强患者参与，并促进医疗研究。

MCP为医疗人员使用大语言模型提供了前所未有的机会，降低了技术门槛，增强了数据安全和隐私保护，提高了系统互操作性，适应了复杂的医疗工作流程，并促进了医疗AI的持续创新。

随着MCP标准的不断发展和完善，我们可以期待看到更多创新的实现和应用场景，特别是在医疗领域。对于医疗机构和医疗专业人员来说，了解和采用MCP将是利用AI技术潜力的关键步骤，使他们能够在日益数字化的医疗环境中提供更高质量的患者护理。

## 参考资料

1. Anthropic. (2024). Introducing the Model Context Protocol. https://www.anthropic.com/news/model-context-protocol

2. Model Context Protocol. (2025). Introduction. https://modelcontextprotocol.io/introduction

3. deepset. (2025). Understanding the Model Context Protocol (MCP). https://www.deepset.ai/blog/understanding-the-model-context-protocol-mcp

4. OpenAI. (2025). Model context protocol (MCP) - OpenAI Agents SDK. https://openai.github.io/openai-agents-python/mcp/

5. Mindbowser. (2025). Model Context Protocol: How It is Changing Healthcare Chatbots. https://www.mindbowser.com/model-context-protocol/

6. Stytch. (2025). Model Context Protocol (MCP): A comprehensive introduction. https://stytch.com/blog/model-context-protocol-introduction/

7. Zapier. (2025). What is MCP (Model Context Protocol)? https://zapier.com/blog/mcp/

8. Humanloop. (2025). Model Context Protocol (MCP) Explained. https://humanloop.com/blog/mcp

